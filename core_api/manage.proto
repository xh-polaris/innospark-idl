syntax = "proto3";

package manage;

option go_package = "manage";

import "basic/page.proto";
import "basic/re.proto";
import "basic/http.proto";

message AdminLoginReq {
  string account = 1;
  string password = 2;
}
message AdminLoginResp {
  basic.Response resp = 1;
  string token = 2;
}

message User {
  string id = 1;
  string phone = 2;
  string name = 3;
  string avatar = 4;
  int32 warnings = 5;
  int32 status = 6;
  int64 expire = 7;
  int64 loginTime = 8;
  int64 createTime = 9;
  int64 updateTime = 10;
}

message ListUserReq {
  basic.Page page = 1;
  int32 status = 2;
  int32 sortedBy = 3;
  int32 reverse = 4;
}
message ListUserResp {
  basic.Response resp = 1;
  int64 total = 2;
  repeated User user = 3;
}

message ForbiddenUserReq {
  string id = 1;
  int32 status = 2; // normal:0 forbidden:1
  optional int64 expire = 3;
}
message ForbiddenUserResp {
  basic.Response resp = 1;
}

message ListFeedBackReq {
  basic.Page page = 1;
  optional string messageId = 2;
  optional string userId = 3;
  optional int32 action = 4;
  optional int32 type = 5;
}
message ListFeedBackResp {
  message FeedBack {
    string messageId = 1;
    string userId = 2;
    int32 action = 3;
    int32 type = 4;
    string content = 5;
    int64 createTime = 6;
  }
  basic.Response resp = 1;
  repeated FeedBack feedbacks = 2;
  int64 total = 3;
}

message UserStatisticsReq  {
  int64 start = 1;
  int64 end = 2;
}
message UserStatisticsResp {
  message Item {
    int64 date = 1;
    int64 count = 2;
  }
  message Trend {
    double w = 1; // 斜率 w，用于表示用户累计趋势的增长速度
    double b = 2; // 截距 b，用于表示趋势线在 x=0 时的理论值
  }
  basic.Response resp = 1;
  repeated Item growth = 2; // 柱状图：每日新增用户数据
  repeated Item accumulate = 3; // 折线图：每日累计用户数据
  Trend trend = 4; // 直线, 趋势
  int64 totalNewUsers = 5; // 统计周期内总新增用户数
  double averageDailyGrowth = 6; // 统计周期内的日均新增用户数
}